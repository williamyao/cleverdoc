;---------------------------------------------------------------------
;  TESTING OPERATIONS

(in-package #:cleverdoc)

(define-op ==> (left right)
  `((,@*fn* ,@left) === ,@right))

(define-op ==/ (left right)
  `((,@*fn* ,@left) =/= ,@right))

(define-op === (left right)
  (unless (= (length left) 1)
    (error "Left-side argument to === should be a single form"))
  `(handler-case
       (if (equal (subseq (multiple-value-list ,@left)
                          0 ,(length right))
                  (list ,@right))
           (pass)
           (fail ,(format nil "狺蒋浸狺戾骠蜷玷舂┅ㄥ蝌矧ㄥㄦ衢ㄦ矧磲铋⑴钽秕铘弪邃弪蝻轭浇浸狺К漓彐К蜷玷舂┅┅ㄤ彐轭瀛镳蒋戾骠蜷玷舂躅戾篌戾铉翳戾骠暴ㄥ蝌矧⑻彐舡箝溴狎珲礤铘麸蒋箬秕熹忮箝铉戾骘蝽┅啜栳钿戾颦汜箦ㄩ铒ㄥ聃犰篚怏羼眭祠轲戾鲠祯瀛扉篝漓彐舂戾铉翳蜷玷舂扉篝莉殓梏┅疳篌ㄦ衢ㄦ矧磲铋狺浇浸狺戾骠蜷玷舂┅ㄥ蝌矧ㄥㄦ衢ㄦ矧磲铋⑴钽秕铘弪邃弪蝻轭蒋浸狺К漓彐К蜷玷舂┅┅ㄤ彐轭瀛镳浇戾骠蜷玷舂啜ì廓骖漓彐舂进莉殓梏┅ㄤ彐轭瀛镳进戾骠蜷玷舂躅戾篌戾铉翳戾骠暴ㄥ蝌矧⑻彐舡箝溴狎珲礤铘麸浇箬秕熹忮箝铉戾骘蝽┅啜栳钿戾颦汜箦漓彐括磲疸狎灬礅溽ㄥ啜ī疳篌┅蜷玷舂ê铒弪蝻é蝈篝蝈篝ㄤ邈灬蝈ㄩ珙矧蝈篝┅ㄦ衢ㄦ矧磲铋⑽弪蝻孱泔躅翦蝈轭岙呆揍铘邃镱镦狺ㄣ狎戾骠蜷玷舂┅┅ㄤ彐躅秕麴豸豉疱箦皓豉疱汜箦箦篝蜷铉с栳蜥泗弪э泗弭┅ㄤ彐轭瀛镳浇揪戾骠蜷玷舂啜戾è秕酏磲脲轭礤盹蝙秕麴豸篝蝈犴哄戾礤铘豉疱秕麴豸豉疱ㄣ狎蜷玷舂┅┅ㄨ犷潇弪汜箦ì廓骖漓彐舂ㄥ蝌矧ㄥㄦ衢ㄦ矧磲铋⑴钽秕铘弪邃弪蝻呆麒殪弼犰踽糸铉岙Ж廓骖漓彐舂┅┅ㄩㄥ聃犰ㄧ弭秕麴豸篝蝈犴箦聃孱沐秕酏ㄣ狎蜷玷舂疳篌ㄦ衢ㄦ矧磲铋狺狺溟铒黩轸秕螽骖戾骠ㄣ狎蜷玷舂┅┅ㄤ彐轭瀛镳揪戾骠蜷玷舂啜戾è轭磲脲轭礤盹蝙轭瘐舡篝蝈犴豉疱汜箦ㄣ狎戾骠鲥泗矧ㄣ狎戾骠┅ㄣ镥蜚戾骠鲥泗矧┅┅┅蜷玷舂